{% extends "base.html" %}

{% block content %}
<div class="home-container">
    <div class="content-wrapper">
        <!-- Ana ƒ∞√ßerik -->
        <div class="main-content-area">
            <!-- Hero Section (Sadece ana sayfada) -->
            {% if not current_category and not request.args.get('query') %}
            <section class="hero">
                <h1 class="hero-title">D√º≈ü√ºncelerinizi payla≈üƒ±n</h1>
                <p class="hero-subtitle">Yazƒ±n, okuyun ve ilham veren fikirleri ke≈üfedin.</p>
                {% if not current_user.is_authenticated %}
                <a href="{{ url_for('register') }}" class="btn btn-write btn-hero">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 20h9"></path>
                        <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
                    </svg>
                    Yazmaya Ba≈üla</a>
                {% endif %}
            </section>
            {% endif %}
            
            <div class="posts-section">
            {% if current_category %}
            <div class="section-header">
                <h2 class="section-title">{{ current_category.name }}</h2>
                <a href="{{ url_for('index') }}" class="btn btn-outline btn-sm">T√ºm√ºn√º G√∂r</a>
            </div>
            {% endif %}

            {% if posts.items %}
            <div class="posts-list">
                {% for post in posts.items %}
                <article class="post-card">
                    <div class="post-card-content">
                        <div class="post-meta">
                            <a href="{{ url_for('user_profile', username=post.author.username) }}" class="post-author">
                                <div class="avatar avatar-sm">{{ post.author.username[0].upper() }}</div>
                                <span>{{ post.author.username }}</span>
                            </a>
                            <span class="meta-separator">¬∑</span>
                            <time class="post-date">{{ post.date_posted.strftime('%d %b %Y') }}</time>
                        </div>

                        <a href="{{ url_for('post_detail', post_id=post.id) }}" class="post-link">
                            <h2 class="post-title">{{ post.title }}</h2>
                            <p class="post-excerpt">{{ post.get_summary(200) }}</p>
                        </a>

                        <div class="post-footer">
                            <div class="post-tags">
                                {% if post.category %}
                                <a href="{{ url_for('category_posts', category_id=post.category.id) }}" class="tag">
                                    {{ post.category.name }}
                                </a>
                                {% endif %}
                            </div>
                            <div class="post-stats">
                                <span class="stat">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path
                                            d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z">
                                        </path>
                                    </svg>
                                    {{ post.like_count }}
                                </span>
                                <span class="stat">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                                    </svg>
                                    {{ post.comment_count }}
                                </span>
                            </div>
                        </div>
                    </div>
                </article>
                {% endfor %}
            </div>

            <!-- Pagination -->
            {% if posts.has_prev or posts.has_next %}
            <nav class="pagination">
                {% if posts.has_prev %}
                <a href="{{ url_for(request.endpoint, page=posts.prev_num, **request.view_args) }}"
                    class="btn btn-outline">
                    ‚Üê √ñnceki
                </a>
                {% endif %}

                <span class="page-info">Sayfa {{ posts.page }} / {{ posts.pages }}</span>

                {% if posts.has_next %}
                <a href="{{ url_for(request.endpoint, page=posts.next_num, **request.view_args) }}"
                    class="btn btn-outline">
                    Sonraki ‚Üí
                </a>
                {% endif %}
            </nav>
            {% endif %}
            {% else %}
            <div class="empty-state">
                <div class="empty-icon">üì≠</div>
                <h3>Hen√ºz yazƒ± yok</h3>
                <p>ƒ∞lk yazƒ±yƒ± siz payla≈üƒ±n!</p>
                {% if current_user.is_authenticated %}
                <a href="{{ url_for('create_post') }}" class="btn btn-primary">Yazƒ± Olu≈ütur</a>
                {% endif %}
            </div>
            {% endif %}
            </div>
        </div>

        <!-- Sidebar -->
        <aside class="sidebar">
            <!-- Kategoriler -->
            <div class="sidebar-section">
                <h3 class="sidebar-title">Kategoriler</h3>
                <div class="category-list">
                    {% for category in categories %}
                        <a href="{{ url_for('category_posts', category_id=category.id) }}"
                           class="pill {% if current_category and current_category.id == category.id %}active{% endif %}"
                           data-category="{{ category.name|trim }}">
                            {{ category.name }}
                            <span>{{ category.posts.count() }}</span>
                        </a>
                    {% else %}
                    <p class="sidebar-empty">Hen√ºz kategori yok</p>
                    {% endfor %}
                </div>
            </div>

            <!-- Pop√ºler Yazarlar -->
            <div class="sidebar-section">
                <h3 class="sidebar-title">Pop√ºler Yazarlar</h3>
                <div class="popular-posts">
                    {% for post in posts.items[:3] %}
                    <a href="{{ url_for('post_detail', post_id=post.id) }}" class="popular-post">
                        <span class="popular-rank">{{ post.author.username[0].upper()}}</span>
                        <div class="popular-info">
                            <span class="popular-title">{{ post.author.username }}</span>
                            <span class="popular-author"> {{ post.author.posts.count() }} Yazƒ±</span>
                        </div>
                    </a>
                    {% endfor %}
                </div>
            </div>
        </aside>
    </div>
</div>
{% endblock %}