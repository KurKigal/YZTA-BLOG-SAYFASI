{% extends "base.html" %}

{% block content %}
<div class="home-container">
    <div class="content-wrapper">
        <div class="posts-section">
            <div class="section-header">
                <h2 class="section-title">
                    "{{ query }}" i√ßin arama sonu√ßlarƒ±
                    <span class="result-count">({{ posts.total }} sonu√ß)</span>
                </h2>
            </div>

            {% if posts.items %}
            <div class="posts-list">
                {% for post in posts.items %}
                <article class="post-card">
                    <div class="post-card-content">
                        <div class="post-meta">
                            <a href="{{ url_for('user_profile', username=post.author.username) }}" class="post-author">
                                <div class="avatar avatar-sm">{{ post.author.username[0].upper() }}</div>
                                <span>{{ post.author.username }}</span>
                            </a>
                            <span class="meta-separator">¬∑</span>
                            <time class="post-date">{{ post.date_posted.strftime('%d %b %Y') }}</time>
                        </div>

                        <a href="{{ url_for('post_detail', post_id=post.id) }}" class="post-link">
                            <h2 class="post-title">{{ post.title }}</h2>
                            <p class="post-excerpt">{{ post.get_summary(200) }}</p>
                        </a>

                        <div class="post-footer">
                            <div class="post-tags">
                                {% if post.category %}
                                <a href="{{ url_for('category_posts', category_id=post.category.id) }}" class="tag">
                                    {{ post.category.name }}
                                </a>
                                {% endif %}
                            </div>
                            <div class="post-stats">
                                <span class="stat">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path
                                            d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z">
                                        </path>
                                    </svg>
                                    {{ post.like_count }}
                                </span>
                                <span class="stat">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                        stroke-linejoin="round">
                                        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                                    </svg>
                                    {{ post.comment_count }}
                                </span>
                            </div>
                        </div>
                    </div>
                </article>
                {% endfor %}
            </div>

            <!-- Pagination -->
            {% if posts.has_prev or posts.has_next %}
            <nav class="pagination">
                {% if posts.has_prev %}
                <a href="{{ url_for('search', query=query, page=posts.prev_num) }}" class="btn btn-outline">
                    ‚Üê √ñnceki
                </a>
                {% endif %}

                <span class="page-info">Sayfa {{ posts.page }} / {{ posts.pages }}</span>

                {% if posts.has_next %}
                <a href="{{ url_for('search', query=query, page=posts.next_num) }}" class="btn btn-outline">
                    Sonraki ‚Üí
                </a>
                {% endif %}
            </nav>
            {% endif %}
            {% else %}
            <div class="empty-state">
                <div class="empty-icon">üîç</div>
                <h3>Sonu√ß bulunamadƒ±</h3>
                <p>"{{ query }}" i√ßin herhangi bir yazƒ± bulunamadƒ±.</p>
                <a href="{{ url_for('index') }}" class="btn btn-primary">Ana Sayfaya D√∂n</a>
            </div>
            {% endif %}
        </div>

        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-section">
                <h3 class="sidebar-title">Kategoriler</h3>
                <div class="category-list">
                    {% for category in categories %}
                    <a href="{{ url_for('category_posts', category_id=category.id) }}" class="category-item">
                        {{ category.name }}
                        <span class="category-count">{{ category.posts.count() }}</span>
                    </a>
                    {% endfor %}
                </div>
            </div>
        </aside>
    </div>
</div>
{% endblock %}